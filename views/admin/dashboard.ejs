<% layout('../partials/layout') %>

    <section class="space-y-6">
        <header class="flex flex-col sm:flex-row sm:items-center justify-between gap-3">
            <div>
                <h1 class="text-2xl font-semibold text-slate-50">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
                <p class="text-sm text-slate-300/90">
                    –ü—Ä–∏–≤–µ—Ç, <span class="text-sky-200 font-semibold"><%= currentUser.username %></span>.
                </p>
            </div>

            <div class="flex flex-col items-end gap-2 text-xs">
                <!-- –í–µ—Ä—Ö–Ω–∏–π —Ä—è–¥ ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ -->
                <div class="flex flex-wrap gap-2">
                    <a href="/admin/interviews/new" class="px-3 py-1.5 rounded-xl bg-sky-500 hover:bg-sky-400 text-slate-950 font-semibold transition">
        + –ò–Ω—Ç–µ—Ä–≤—å—é
      </a>
                    <a href="/admin/publications/new" class="px-3 py-1.5 rounded-xl bg-emerald-500 hover:bg-emerald-400 text-slate-950 font-semibold transition">
        + –ü—É–±–ª–∏–∫–∞—Ü–∏—è
      </a>
                    <a href="/admin/posts/new" class="px-3 py-1.5 rounded-xl bg-violet-500 hover:bg-violet-400 text-slate-950 font-semibold transition">
        + –ü–æ—Å—Ç ¬´–§–∞—Ä–º–∞-–∂–∏–∑–Ω—å¬ª
      </a>
                </div>

                <!-- –ù–∏–∂–Ω–∏–π —Ä—è–¥ ‚Äî –ø–µ—Ä–µ—Ö–æ–¥—ã –∫ —Å–ø–∏—Å–∫–∞–º -->
                <div class="flex flex-wrap gap-2">
                    <a href="/admin/interviews" class="px-3 py-1.5 rounded-xl border border-sky-400/70 text-sky-100 bg-slate-900/60 hover:bg-sky-500/15 transition">
        –í—Å–µ –∏–Ω—Ç–µ—Ä–≤—å—é
      </a>
                    <a href="/admin/publications" class="px-3 py-1.5 rounded-xl border border-emerald-400/70 text-emerald-100 bg-slate-900/60 hover:bg-emerald-500/15 transition">
        –í—Å–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
      </a>
                    <a href="/admin/posts" class="px-3 py-1.5 rounded-xl border border-violet-400/70 text-violet-100 bg-slate-900/60 hover:bg-violet-500/15 transition">
        –í—Å–µ –ø–æ—Å—Ç—ã ¬´–§–∞—Ä–º–∞-–∂–∏–∑–Ω—å¬ª
      </a>
                </div>
            </div>
        </header>



        <div class="grid gap-4 sm:grid-cols-4">
            <!-- –í—Å–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏–π -->
            <div class="rounded-2xl border border-white/10 bg-slate-900/70 p-4 space-y-3">
                <div class="text-xs text-slate-300/85 mb-1">–ü–æ—Å–µ—â–µ–Ω–∏–π –≤—Å–µ–≥–æ</div>
                <div class="text-2xl font-semibold text-sky-300">
                    <%= totalVisitsAllTime || 0 %>
                </div>

                <form action="/admin/reset-visits" method="POST" onsubmit="return confirm('–¢–æ—á–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–æ—Å–µ—â–µ–Ω–∏—è–º? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.');">
                    <button type="submit" class="text-[11px] px-3 py-1.5 rounded-xl border border-red-400/70 text-red-100 bg-slate-950/60 hover:bg-red-500/20 hover:border-red-300 transition">
                        –°–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç—á–∏–∫
                    </button>
                </form>
            </div>

            <!-- üîπ –ù–æ–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
            <div class="rounded-2xl border border-white/10 bg-slate-900/70 p-4 space-y-2">
                <div class="text-xs text-slate-300/85 mb-1">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                <div class="text-2xl font-semibold text-emerald-300">
                    <%= totalUsers || 0 %>
                </div>
                <% if (typeof totalAdmins !== 'undefined') { %>
                    <div class="text-[11px] text-slate-400/85">
                        –ê–¥–º–∏–Ω–æ–≤: <span class="text-sky-200"><%= totalAdmins %></span>
                    </div>
                    <% } %>
            </div>

            <!-- –ü–æ—Å–µ—â–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π -->
            <div class="rounded-2xl border border-white/10 bg-slate-900/70 p-4 sm:col-span-2">
                <div class="text-xs text-slate-300/85 mb-2">–ü–æ—Å–µ—â–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</div>
                <% if (!visitsLast7.length) { %>
                    <p class="text-xs text-slate-400/85">–ü–æ–∫–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø–æ—Å–µ—â–µ–Ω–∏—è–º.</p>
                    <% } else { %>
                        <div class="grid grid-cols-7 gap-2 text-[11px]">
                            <% visitsLast7.slice().reverse().forEach(function(v){ %>
                                <div class="rounded-xl border border-white/10 bg-slate-950/70 p-2 text-center">
                                    <div class="text-slate-300/85">
                                        <%= v.date.slice(5) %>
                                    </div>
                                    <div class="mt-1 font-semibold text-sky-200">
                                        <%= v.count %>
                                    </div>
                                </div>
                                <% }) %>
                        </div>
                        <% } %>
            </div>
        </div>


        <section class="space-y-2">
            <h2 class="text-sm font-semibold text-slate-100">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏ ¬´–§–∞—Ä–º–∞-–∂–∏–∑–Ω—å¬ª</h2>
            <% if (!latestPosts.length) { %>
                <p class="text-xs text-slate-400/85">–ü–æ—Å—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
                <% } else { %>
                    <div class="space-y-1">
                        <% latestPosts.forEach(function(p){ %>
                            <div class="flex justify-between items-center rounded-xl border border-white/10 bg-slate-900/70 px-3 py-2 text-xs">
                                <div class="truncate mr-2">
                                    <span class="font-semibold text-slate-50"><%= p.title %></span>
                                    <span class="text-slate-400/85"> ¬∑ <%= new Date(p.created_at).toLocaleDateString('ru-RU') %></span>
                                </div>
                                <div class="text-slate-300/90">
                                    üëÅ
                                    <%= p.views %>
                                </div>
                            </div>
                            <% }) %>
                    </div>
                    <% } %>
        </section>
    </section>